<!doctype>
<html lang="en">
    <head>
        <meta charset="utf8">
        <link rel="stylesheet" type="text/css" href="styles/style.css">
    </head>
    <body>
        <p>Please choose a user name: [default is 'player1']</p>
        <input id="alias" type="text" value="player1"></input>
        <button id="submit">Submit</button>

        <script src="https://code.jquery.com/jquery-2.2.0.min.js">
        </script>
        <script>
          // gets alias, submits it to '/player1' on server,
          // then receives a gametoken to identify game uniquely
          // then stores it in window.localStorage  and redirects to the game
            var aliasInput = $('#alias');            
            var btn = $('#submit');            

            btn.on('click', function(ev) {
                // send alias, player  
                // get back all data to put in localstorage (player, alias, gameToken  
                var alias = aliasInput.val();
                var data = {
                    alias: alias,
                    player: 'player1'
                };
                console.log(JSON.stringify(data));
                $.ajax({
                    method: 'POST',
                    url: '/player1',
                    data: JSON.stringify(data)
                })
                .done(function(res) {
                    var lsObj = {
                        gameToken: res.gameToken,
                        player:    'player2',
                        alias:     res.alias,
                    };
                    // store game data
                    window.localStorage.setItem('netchess-data',JSON.stringify(lsObj));
                    // advance to /game
                    window.location = "/game";
                });
            });
        </script>
    </body>
</html>
